{% extends 'app/admin_home.html' %}
{% load static %}
{% block title %}User List{% endblock title %}



{% block admin %}

<style>
.passport-size {
    max-width: 150px; /* Set the maximum width */
    max-height: 150px; /* Set the maximum height */
}
.card-body{
    background-color: #e8edea;
    margin-top:3rem;
    margin-bottom:5rem;
    border-radius:2rem;
    padding:1.5rem;
    }
</style>

<div class="container-fluid">
    <div class="row">

        <div class="col-lg-10 card-body">
    <h1>Admin Orders</h1>

    <form method="GET">
        <label for="search">Search Product:</label>
        <input type="text" name="search" id="search">
        <input type="submit" class="btn-success" value="Search">
    </form>

    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Order ID</th>
                <th>User</th>
                <th>Ordered Date</th>
                <th>Address</th>
                <th>Order items</th>
                <th>Total Price</th>
                <th>Order Status</th>
                <th>Edit Status</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td>{{ order.id }}</td>
                <td>{{ order.username }}</td>
                <td>{{ order.ordered_date }}</td>
                <td>
                    <li><strong>Billing Address:  </strong>{{ order.billing_address.name }}, {{ order.billing_address.locality }},
                        <br>{{ order.billing_address.city }}, {{ order.billing_address.state }}-{{ order.billing_address.pincode }}, Ph-{{ order.billing_address.phone_number }}</li>
                    <li><strong>Shipping Address:  </strong>{{ order.shipping_address.name }}, {{ order.shipping_address.locality }},
                        <br>{{ order.shipping_address.city }}, {{ order.shipping_address.state }}-{{ order.shipping_address.pincode }}, Ph-{{ order.shipping_address.phone_number }}</li>
                </td>
                <td>
                    {% for order_item in order.orderitem_set.all %}
                    <li><strong>{{ order_item.product.title }}</strong> - Qty {{ order_item.quantity }} x {{order_item.price_per_product}}</li>
                    {% endfor %}
                </td>
                <td>{{ order.total_price }}</td>
                <td>{{ order.order_status }}</td>
                <td>
                    <form method="POST" action="{% url 'admin_edit_order_status' order.id %}">
                        {% csrf_token %}
                        <select name="order_status" >
                            {% for choice in order.ORDER_STATUS_CHOICES %}
                                     <option value="{{ choice.0 }}" {% if choice.0 == order.order_status %}selected{% endif %}>{{ choice.1 }}</option>
                            {% endfor %}
                        </select>
                        <button type="submit" class="btn btn-primary btn-rounded">Change</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
        </div>
    </div>
</div>


<!-- Pagination -->
<div style="text-align: center; margin-top: 20px;">
  <nav aria-label="Page navigation example">
    <ul class="pagination">
      {% if orders.has_previous %}
      <li class="page-item">
        <a class="page-link" href="{% url 'admin_orders' %}?page=1" aria-label="First"><span aria-hidden="true">&laquo;</span> first
        </a>
      </li>
      <li class="page-item">
        <a class="page-link" href="{% url 'admin_orders' %}?page={{ orders.previous_page_number }}" aria-label="Previous">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>
      {% endif %}
      {% for n in page_range %}
      <li class="page-item{% if n == orders.number %} active{% endif %}">
        <a class="page-link" href="{% url 'admin_orders' %}?page={{ n }}">{{ n }}</a>
      </li>
      {% endfor %}
      {% if orders.has_next %}
      <li class="page-item">
        <a class="page-link" href="{% url 'admin_orders' %}?page={{ orders.next_page_number }}" aria-label="Next">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
      <li class="page-item">
        <a class="page-link" href="{% url 'admin_orders' %}?page={{ lastpage }}" aria-label="Last">last <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
      {% endif %}
    </ul>
  </nav>
</div>
<!-- Pagination -->


{% endblock admin %}